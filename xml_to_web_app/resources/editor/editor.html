<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Éditeur WYSIWYG</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.2/tinymce.min.js"></script>
    <style>
        body { 
            margin: 0; 
            padding: 10px; 
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        #editor-container {
            background-color: white;
            border-radius: 4px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div id="editor-container">
        <textarea id="wysiwyg-editor" style="width: 100%; height: 400px;">
            <p>Commencez à écrire votre contenu ici...</p>
        </textarea>
    </div>
    
    <script>
        tinymce.init({
            selector: '#wysiwyg-editor',
            height: 400,
            menubar: false,
            plugins: [
                'advlist', 'autolink', 'lists', 'link', 'image', 'charmap',
                'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
                'insertdatetime', 'media', 'table', 'preview', 'help', 'wordcount'
            ],
            toolbar: 'undo redo | blocks | ' +
                'bold italic | alignleft aligncenter ' +
                'alignright alignjustify | bullist numlist outdent indent | ' +
                'removeformat | help',
            content_style: 'body { font-family: Arial, sans-serif; font-size: 14px }',
            setup: function (editor) {
                editor.on('init', function () {
                    console.log('TinyMCE initialisé');
                    window.editorReady = true;
                    if (window.pyqt_bridge) {
                        window.pyqt_bridge.editor_ready();
                    }
                });
                
                editor.on('change keyup setcontent', function () {
                    const content = editor.getContent();
                    if (window.pyqt_bridge) {
                        window.pyqt_bridge.content_changed(content);
                    }
                });
            }
        });
        
        // Interface JavaScript pour communication avec PyQt
        window.editorInterface = {
            setContent: function(html) {
                if (tinymce.activeEditor) {
                    tinymce.activeEditor.setContent(html);
                }
            },
            
            getContent: function() {
                if (tinymce.activeEditor) {
                    return tinymce.activeEditor.getContent();
                }
                return '';
            },
            
            insertContent: function(html) {
                if (tinymce.activeEditor) {
                    tinymce.activeEditor.insertContent(html);
                }
            },
            
            focus: function() {
                if (tinymce.activeEditor) {
                    tinymce.activeEditor.focus();
                }
            }
        };
    </script>
</body>
</html>